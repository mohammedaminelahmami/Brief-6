{"ast":null,"code":"import { argsert } from './argsert.js';\nimport { isPromise } from './utils/is-promise.js';\nexport function globalMiddlewareFactory(globalMiddleware, context) {\n  return function (callback) {\n    let applyBeforeValidation = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    argsert('<array|function> [boolean]', [callback, applyBeforeValidation], arguments.length);\n\n    if (Array.isArray(callback)) {\n      for (let i = 0; i < callback.length; i++) {\n        if (typeof callback[i] !== 'function') {\n          throw Error('middleware must be a function');\n        }\n\n        callback[i].applyBeforeValidation = applyBeforeValidation;\n      }\n\n      Array.prototype.push.apply(globalMiddleware, callback);\n    } else if (typeof callback === 'function') {\n      callback.applyBeforeValidation = applyBeforeValidation;\n      globalMiddleware.push(callback);\n    }\n\n    return context;\n  };\n}\nexport function commandMiddlewareFactory(commandMiddleware) {\n  if (!commandMiddleware) return [];\n  return commandMiddleware.map(middleware => {\n    middleware.applyBeforeValidation = false;\n    return middleware;\n  });\n}\nexport function applyMiddleware(argv, yargs, middlewares, beforeValidation) {\n  const beforeValidationError = new Error('middleware cannot return a promise when applyBeforeValidation is true');\n  return middlewares.reduce((acc, middleware) => {\n    if (middleware.applyBeforeValidation !== beforeValidation) {\n      return acc;\n    }\n\n    if (isPromise(acc)) {\n      return acc.then(initialObj => Promise.all([initialObj, middleware(initialObj, yargs)])).then(_ref => {\n        let [initialObj, middlewareObj] = _ref;\n        return Object.assign(initialObj, middlewareObj);\n      });\n    } else {\n      const result = middleware(acc, yargs);\n      if (beforeValidation && isPromise(result)) throw beforeValidationError;\n      return isPromise(result) ? result.then(middlewareObj => Object.assign(acc, middlewareObj)) : Object.assign(acc, result);\n    }\n  }, argv);\n}","map":{"version":3,"sources":["C:/Users/YC/Desktop/brief6-frontend/node_modules/yargs/build/lib/middleware.js"],"names":["argsert","isPromise","globalMiddlewareFactory","globalMiddleware","context","callback","applyBeforeValidation","arguments","length","Array","isArray","i","Error","prototype","push","apply","commandMiddlewareFactory","commandMiddleware","map","middleware","applyMiddleware","argv","yargs","middlewares","beforeValidation","beforeValidationError","reduce","acc","then","initialObj","Promise","all","middlewareObj","Object","assign","result"],"mappings":"AAAA,SAASA,OAAT,QAAwB,cAAxB;AACA,SAASC,SAAT,QAA0B,uBAA1B;AACA,OAAO,SAASC,uBAAT,CAAiCC,gBAAjC,EAAmDC,OAAnD,EAA4D;AAC/D,SAAO,UAAUC,QAAV,EAAmD;AAAA,QAA/BC,qBAA+B,uEAAP,KAAO;AACtDN,IAAAA,OAAO,CAAC,4BAAD,EAA+B,CAACK,QAAD,EAAWC,qBAAX,CAA/B,EAAkEC,SAAS,CAACC,MAA5E,CAAP;;AACA,QAAIC,KAAK,CAACC,OAAN,CAAcL,QAAd,CAAJ,EAA6B;AACzB,WAAK,IAAIM,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGN,QAAQ,CAACG,MAA7B,EAAqCG,CAAC,EAAtC,EAA0C;AACtC,YAAI,OAAON,QAAQ,CAACM,CAAD,CAAf,KAAuB,UAA3B,EAAuC;AACnC,gBAAMC,KAAK,CAAC,+BAAD,CAAX;AACH;;AACDP,QAAAA,QAAQ,CAACM,CAAD,CAAR,CAAYL,qBAAZ,GAAoCA,qBAApC;AACH;;AACDG,MAAAA,KAAK,CAACI,SAAN,CAAgBC,IAAhB,CAAqBC,KAArB,CAA2BZ,gBAA3B,EAA6CE,QAA7C;AACH,KARD,MASK,IAAI,OAAOA,QAAP,KAAoB,UAAxB,EAAoC;AACrCA,MAAAA,QAAQ,CAACC,qBAAT,GAAiCA,qBAAjC;AACAH,MAAAA,gBAAgB,CAACW,IAAjB,CAAsBT,QAAtB;AACH;;AACD,WAAOD,OAAP;AACH,GAhBD;AAiBH;AACD,OAAO,SAASY,wBAAT,CAAkCC,iBAAlC,EAAqD;AACxD,MAAI,CAACA,iBAAL,EACI,OAAO,EAAP;AACJ,SAAOA,iBAAiB,CAACC,GAAlB,CAAsBC,UAAU,IAAI;AACvCA,IAAAA,UAAU,CAACb,qBAAX,GAAmC,KAAnC;AACA,WAAOa,UAAP;AACH,GAHM,CAAP;AAIH;AACD,OAAO,SAASC,eAAT,CAAyBC,IAAzB,EAA+BC,KAA/B,EAAsCC,WAAtC,EAAmDC,gBAAnD,EAAqE;AACxE,QAAMC,qBAAqB,GAAG,IAAIb,KAAJ,CAAU,uEAAV,CAA9B;AACA,SAAOW,WAAW,CAACG,MAAZ,CAAmB,CAACC,GAAD,EAAMR,UAAN,KAAqB;AAC3C,QAAIA,UAAU,CAACb,qBAAX,KAAqCkB,gBAAzC,EAA2D;AACvD,aAAOG,GAAP;AACH;;AACD,QAAI1B,SAAS,CAAC0B,GAAD,CAAb,EAAoB;AAChB,aAAOA,GAAG,CACLC,IADE,CACGC,UAAU,IAAIC,OAAO,CAACC,GAAR,CAAY,CAChCF,UADgC,EAEhCV,UAAU,CAACU,UAAD,EAAaP,KAAb,CAFsB,CAAZ,CADjB,EAKFM,IALE,CAKG;AAAA,YAAC,CAACC,UAAD,EAAaG,aAAb,CAAD;AAAA,eAAiCC,MAAM,CAACC,MAAP,CAAcL,UAAd,EAA0BG,aAA1B,CAAjC;AAAA,OALH,CAAP;AAMH,KAPD,MAQK;AACD,YAAMG,MAAM,GAAGhB,UAAU,CAACQ,GAAD,EAAML,KAAN,CAAzB;AACA,UAAIE,gBAAgB,IAAIvB,SAAS,CAACkC,MAAD,CAAjC,EACI,MAAMV,qBAAN;AACJ,aAAOxB,SAAS,CAACkC,MAAD,CAAT,GACDA,MAAM,CAACP,IAAP,CAAYI,aAAa,IAAIC,MAAM,CAACC,MAAP,CAAcP,GAAd,EAAmBK,aAAnB,CAA7B,CADC,GAEDC,MAAM,CAACC,MAAP,CAAcP,GAAd,EAAmBQ,MAAnB,CAFN;AAGH;AACJ,GApBM,EAoBJd,IApBI,CAAP;AAqBH","sourcesContent":["import { argsert } from './argsert.js';\nimport { isPromise } from './utils/is-promise.js';\nexport function globalMiddlewareFactory(globalMiddleware, context) {\n    return function (callback, applyBeforeValidation = false) {\n        argsert('<array|function> [boolean]', [callback, applyBeforeValidation], arguments.length);\n        if (Array.isArray(callback)) {\n            for (let i = 0; i < callback.length; i++) {\n                if (typeof callback[i] !== 'function') {\n                    throw Error('middleware must be a function');\n                }\n                callback[i].applyBeforeValidation = applyBeforeValidation;\n            }\n            Array.prototype.push.apply(globalMiddleware, callback);\n        }\n        else if (typeof callback === 'function') {\n            callback.applyBeforeValidation = applyBeforeValidation;\n            globalMiddleware.push(callback);\n        }\n        return context;\n    };\n}\nexport function commandMiddlewareFactory(commandMiddleware) {\n    if (!commandMiddleware)\n        return [];\n    return commandMiddleware.map(middleware => {\n        middleware.applyBeforeValidation = false;\n        return middleware;\n    });\n}\nexport function applyMiddleware(argv, yargs, middlewares, beforeValidation) {\n    const beforeValidationError = new Error('middleware cannot return a promise when applyBeforeValidation is true');\n    return middlewares.reduce((acc, middleware) => {\n        if (middleware.applyBeforeValidation !== beforeValidation) {\n            return acc;\n        }\n        if (isPromise(acc)) {\n            return acc\n                .then(initialObj => Promise.all([\n                initialObj,\n                middleware(initialObj, yargs),\n            ]))\n                .then(([initialObj, middlewareObj]) => Object.assign(initialObj, middlewareObj));\n        }\n        else {\n            const result = middleware(acc, yargs);\n            if (beforeValidation && isPromise(result))\n                throw beforeValidationError;\n            return isPromise(result)\n                ? result.then(middlewareObj => Object.assign(acc, middlewareObj))\n                : Object.assign(acc, result);\n        }\n    }, argv);\n}\n"]},"metadata":{},"sourceType":"module"}